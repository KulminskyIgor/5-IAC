# 1. IaC Introduction

## 1.1 Configuration management
### 1.1.1 Before Configuration management

Давайте предствим как создается инфраструктура для проекта, с точки зрения специалиста по конфигурации ПО, или разработчика, которому, например, поручили такое дело в отсуствии специалиста по конфигурации ПО в команде : ему необходимо развернуть приложение и для этого нужен сервер. 

![Before configuration management](../assets/01_06.png?raw=true "Before configuration management")

Он звонит в техподдержку или открывает тикет в системе сервисдеск и просит, что ему нужен новый сервер и учетные данные для подключения к нему. В техподдержке системный администратор получает со склада сервер, распаковывает его, устанавливает в серверную, разворачивает ОС на нем и предоставляет доступ для нашего специалиста. Теперь DevOps инженер может подключиться серверу с только что установленной ОС и начать установку, например пакетов системного и прикладного ПО, нужных версий, (Python, Java, Node, PHP, composer) для сервера приложений, или если это сервер БД, то нужные пакеты для Базы определенной версии,  и вручную скопирует уже имеющиеся конфигурационные файлы на эти сервера. которые необходимы для работы разрабатываемого приложения.

![Before configuration management](../assets/01_07.png?raw=true "Before configuration management")

И в этоге наши сервера превраются в условно говоря, снежинку! Невоспроизводимою, уникальную конфигурацию инфраструктуры, которая при каждом последующем создании будет неповторима. Обьяснить это можно многими причинами, например, человеческим фактором, последующее создание такой инфраструктуры может быть выполнено другим системным администратором, который вроде бы и действует по инструкции, но в силу своей загруженности и мультизадачности, в следующий раз установит ОС с версией немного другой, системное ПО, может быть так же других версий, или вовсе отсутствовать, наш специлист, может не обратить на это внимание, и сам выполнить немного другую последовательность действий в процессе ручной конфигурации ПО. 
CM решает эту проблему со сложностями в воспроизведении конфигурацией.

### 1.1.2 Configuration management

Начнем с небольшого примера, зачем нужен СМ, Например у нас есть в проекте build сервер, с помощью которого мы собираем пакет для последующей установки на STAGE Environment. Пусть это будет веб приложение на PHP  

![Сonfiguration management](../assets/01_19.png?raw=true "Сonfiguration management")
 
Этот сервер во время билда берет код из репозитория проекта, скачивает из интернета зависимости и библиотеки необходимые для нового функционала в проекте, создает архив, который в дальнейшем отправляется на Stage окружение и разворачивается там для финального тестирования перед выходом в продакшон.

![Сonfiguration management](../assets/01_23.png?raw=true "Сonfiguration management")

Однажды выясняется, что нам нужно переехать на новую платформу инфраструктуры, по тем или иным причинам, например для того, чтобы расширить возможности нашего CICD процесса, мы получаем доступ к новой инфраструктуре, решаем переехать. Создаем заново Build-сервер или используем одним из уже имеющихся там расшаренных серверов, с вроде-бы такими же параметрами, 

![Сonfiguration management](../assets/01_25.png?raw=true "Сonfiguration management")

но что-то идет не так. Знания о том, как мы 3 года назад устанавливали наш Build-сервер оказались не документированы, версии установленной OS и необходимых пакетов для Build-сервера не совпали, или некоторые пакеты и вовсе отсуствовали.

И как результат - наш сервер оказался неспособным создать Build 

![Сonfiguration management](../assets/01_26.png?raw=true "Сonfiguration management")

СМ – это про то чтобы обеспечить успешный переезд сервера, про то, чтобы знание о конфигурации сервера было актуально и хранилось в репозитории проекта, как например здесь, в Dockerfile и могло быть воспроизведено бестро и без ошибок.

![Сonfiguration management](../assets/01_27.png?raw=true "Сonfiguration management")

### 1.1.3 Infrastructure as Code (IaC)

СМ – это про такой процесс, который постоянно повторяется, при внесении изменений в конфигурацию, эти изменения документируются, проверяется, что инфраструктура работает, эти знания накапливаются и изучаются совместно в команде, которая работает над созданием приложения.

![Сonfiguration management](../assets/01_29.png?raw=true "Сonfiguration management")

В целом, под инфраструктурой понимают конфигурационные файлы, необходимые для запуска ПО, запущенные сервисы, правила файервола, для предоставления различных доступов, между серверами разработки, в соответствии с политикой безопасности, так же действующие лицензии на платное ПО. 
Задача СМ сводится к тому, чтобы инфраструктура работала и в команде проекта было понимание как это работает. Скорее всего, конечно, не все участники команды обладают этим пониманием, но все знают где можно ознакомиться с подробностями инфраструктуры, и у кого можно проконсультироваться по поводу конфигурации, внутри команды.

И как результат, в работе СМ, вместо снежинки, которая получилась из серверов, при ручной настройке различными специалистами,

![Сonfiguration management](../assets/01_30.png?raw=true "Сonfiguration management")

У нас получилась воспроизводимая конфигурация. Возможно это будет не быстро и не сразу, мы снова будем звонить в техподдержку, чтобы нам установили сервера в стойки, настроили их, но знание об инфраструктуре о том как настроены сервера, в команде известно и хранится, например в вики и мы можем это воспроизвести.

Как следующий этап развития в СМ появился запрос о том, что нужно воспроизводить инфраструктуру быстрее, и вопрос: что делать в случае, если нужно срочно переехать в новый дата центр,  при этом имающийся датацентр больше недоступен и нам нужно все построить с нуля.



### 1.1.4 IaC use cases

### 1.1.5 IaC tooling: Vagrant, Packer, Terraform, Ansible

### 1.1.6 Immutable infrastructure

### 1.1.7 Training environment


## 1.2 IaC: Vagrant, Packer, Terraform, Ansible

## 1.3 Immutable infrastructure

## 1.4 Training environment
